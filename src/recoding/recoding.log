Loading paths...
Loading data 'user_level_counts.tsv'... done! <--- using dask dataframe for big data
Collecting user ids from files...
...fn_sharers.txt...
...suspended_accounts.txt...
...high_activity_accounts.txt...
...moderate_activity_accounts.txt...
...low_activity_accounts.txt...
...qanon_accounts.txt...
...antivax_accounts.txt...
...supersharers.txt...
...supersharers_alt.txt...
...A.txt...
...B.txt...
...D.txt...
...F.txt...
done!
Creating user ids dictionary (nfns and by activity)...done!
Number of users:
fns            : 44,734
suspended      : 1,361
ha             : 8,244
ma             : 381,246
la             : 138,439
qanon          : 904
av             : 372
ss1            : 530
ss5            : 2,238
A              : 6,475
B              : 28,230
D              : 12,945
F              : 15,618
all            : 599,697
nfns           : 554,963
nfns_ha        : 3,256
nfns_ma        : 348,488
nfns_la        : 131,554
A_ha           : 210
B_ha           : 3,274
D_ha           : 2,077
F_ha           : 1,481
A_ma           : 5,140
B_ma           : 21,104
D_ma           : 9,229
F_ma           : 11,167
A_la           : 1,119
B_la           : 3,777
D_la           : 1,592
F_la           : 2,943
Loading data 'user_level_counts_decahose.tsv'... done! <--- using dask dataframe for big data

Collecting Jul 2021 onwards totals from dask into pandas...
Collecting daily totals, avg, and number of users for fns...
Collecting daily totals, avg, and number of users for suspended...
Collecting daily totals, avg, and number of users for ha...
Collecting daily totals, avg, and number of users for ma...
Collecting daily totals, avg, and number of users for la...
Collecting daily totals, avg, and number of users for qanon...
Collecting daily totals, avg, and number of users for av...
Collecting daily totals, avg, and number of users for ss1...
Collecting daily totals, avg, and number of users for ss5...
Collecting daily totals, avg, and number of users for A...
Collecting daily totals, avg, and number of users for B...
Collecting daily totals, avg, and number of users for D...
Collecting daily totals, avg, and number of users for F...
Collecting daily totals, avg, and number of users for all...
Collecting daily totals, avg, and number of users for nfns...
Collecting daily totals, avg, and number of users for nfns_ha...
Collecting daily totals, avg, and number of users for nfns_ma...
Collecting daily totals, avg, and number of users for nfns_la...
Collecting daily totals, avg, and number of users for A_ha...
Collecting daily totals, avg, and number of users for B_ha...
Collecting daily totals, avg, and number of users for D_ha...
Collecting daily totals, avg, and number of users for F_ha...
Collecting daily totals, avg, and number of users for A_ma...
Collecting daily totals, avg, and number of users for B_ma...
Collecting daily totals, avg, and number of users for D_ma...
Collecting daily totals, avg, and number of users for F_ma...
Collecting daily totals, avg, and number of users for A_la...
Collecting daily totals, avg, and number of users for B_la...
Collecting daily totals, avg, and number of users for D_la...
Collecting daily totals, avg, and number of users for F_la...
Loading data 'user_level_counts_2016.tsv'... done! <--- using dask dataframe for big data
Computing daily totals...Collecting daily totals, avg, and number of users for fns...
Collecting daily totals, avg, and number of users for suspended...
Collecting daily totals, avg, and number of users for ha...
Collecting daily totals, avg, and number of users for ma...
Collecting daily totals, avg, and number of users for la...
Collecting daily totals, avg, and number of users for qanon...
Collecting daily totals, avg, and number of users for av...
Collecting daily totals, avg, and number of users for ss1...
Collecting daily totals, avg, and number of users for ss5...
Collecting daily totals, avg, and number of users for A...
Collecting daily totals, avg, and number of users for B...
Collecting daily totals, avg, and number of users for D...
Collecting daily totals, avg, and number of users for F...
Collecting daily totals, avg, and number of users for all...
Collecting daily totals, avg, and number of users for nfns...
Collecting daily totals, avg, and number of users for nfns_ha...
Collecting daily totals, avg, and number of users for nfns_ma...
Collecting daily totals, avg, and number of users for nfns_la...
Collecting daily totals, avg, and number of users for A_ha...
Collecting daily totals, avg, and number of users for B_ha...
Collecting daily totals, avg, and number of users for D_ha...
Collecting daily totals, avg, and number of users for F_ha...
Collecting daily totals, avg, and number of users for A_ma...
Collecting daily totals, avg, and number of users for B_ma...
Collecting daily totals, avg, and number of users for D_ma...
Collecting daily totals, avg, and number of users for F_ma...
Collecting daily totals, avg, and number of users for A_la...
Collecting daily totals, avg, and number of users for B_la...
Collecting daily totals, avg, and number of users for D_la...
Collecting daily totals, avg, and number of users for F_la...
done!
Loading data 'user_level_counts_2019.tsv'... done! <--- using dask dataframe for big data
Collecting 2019 to Jun 2021 totals from dask into pandas...
Collecting daily totals, avg, and number of users for fns...
Collecting daily totals, avg, and number of users for suspended...
Collecting daily totals, avg, and number of users for ha...
Collecting daily totals, avg, and number of users for ma...
Collecting daily totals, avg, and number of users for la...
Collecting daily totals, avg, and number of users for qanon...
Collecting daily totals, avg, and number of users for av...
Collecting daily totals, avg, and number of users for ss1...
Collecting daily totals, avg, and number of users for ss5...
Collecting daily totals, avg, and number of users for A...
Collecting daily totals, avg, and number of users for B...
Collecting daily totals, avg, and number of users for D...
Collecting daily totals, avg, and number of users for F...
Collecting daily totals, avg, and number of users for all...
Collecting daily totals, avg, and number of users for nfns...
Collecting daily totals, avg, and number of users for nfns_ha...
Collecting daily totals, avg, and number of users for nfns_ma...
Collecting daily totals, avg, and number of users for nfns_la...
Collecting daily totals, avg, and number of users for A_ha...
Collecting daily totals, avg, and number of users for B_ha...
Collecting daily totals, avg, and number of users for D_ha...
Collecting daily totals, avg, and number of users for F_ha...
Collecting daily totals, avg, and number of users for A_ma...
Collecting daily totals, avg, and number of users for B_ma...
Collecting daily totals, avg, and number of users for D_ma...
Collecting daily totals, avg, and number of users for F_ma...
Collecting daily totals, avg, and number of users for A_la...
Collecting daily totals, avg, and number of users for B_la...
Collecting daily totals, avg, and number of users for D_la...
Collecting daily totals, avg, and number of users for F_la...
done!
Loading data 'user_level_counts.tsv'... done! <--- using dask dataframe for big data
Collecting Jul 2021 onwards totals from dask into pandas...
Collecting daily totals, avg, and number of users for fns...
Collecting daily totals, avg, and number of users for suspended...
Collecting daily totals, avg, and number of users for ha...
Collecting daily totals, avg, and number of users for ma...
Collecting daily totals, avg, and number of users for la...
Collecting daily totals, avg, and number of users for qanon...
Collecting daily totals, avg, and number of users for av...
Collecting daily totals, avg, and number of users for ss1...
Collecting daily totals, avg, and number of users for ss5...
Collecting daily totals, avg, and number of users for A...
Collecting daily totals, avg, and number of users for B...
Collecting daily totals, avg, and number of users for D...
Collecting daily totals, avg, and number of users for F...
Collecting daily totals, avg, and number of users for all...
Collecting daily totals, avg, and number of users for nfns...
Collecting daily totals, avg, and number of users for nfns_ha...
Collecting daily totals, avg, and number of users for nfns_ma...
Collecting daily totals, avg, and number of users for nfns_la...
Collecting daily totals, avg, and number of users for A_ha...
Collecting daily totals, avg, and number of users for B_ha...
Collecting daily totals, avg, and number of users for D_ha...
Collecting daily totals, avg, and number of users for F_ha...
Collecting daily totals, avg, and number of users for A_ma...
Collecting daily totals, avg, and number of users for B_ma...
Collecting daily totals, avg, and number of users for D_ma...
Collecting daily totals, avg, and number of users for F_ma...
Collecting daily totals, avg, and number of users for A_la...
Collecting daily totals, avg, and number of users for B_la...
Collecting daily totals, avg, and number of users for D_la...
Collecting daily totals, avg, and number of users for F_la...
done!
Concating 2019 and 2020 daily summaries...done!

Data for DiD analysis:
Loading data 'user_level_counts.tsv'... done! <--- using dask dataframe for big data
Subsetting date range (from 2020-12-01 00:00:00 to 2021-01-20 00:00:00)...
Merging group indicator for group *fns* to user-level data ...done!
Merging group indicator for group *suspended* to user-level data ...done!
Merging group indicator for group *ha* to user-level data ...done!
Merging group indicator for group *ma* to user-level data ...done!
Merging group indicator for group *la* to user-level data ...done!
Merging group indicator for group *qanon* to user-level data ...done!
Merging group indicator for group *av* to user-level data ...done!
Merging group indicator for group *ss1* to user-level data ...done!
Merging group indicator for group *ss5* to user-level data ...done!
Merging group indicator for group *A* to user-level data ...done!
Merging group indicator for group *B* to user-level data ...done!
Merging group indicator for group *D* to user-level data ...done!
Merging group indicator for group *F* to user-level data ...done!
Merging group indicator for group *all* to user-level data ...done!
Merging group indicator for group *nfns* to user-level data ...done!
Merging group indicator for group *nfns_ha* to user-level data ...done!
Merging group indicator for group *nfns_ma* to user-level data ...done!
Merging group indicator for group *nfns_la* to user-level data ...done!
Merging group indicator for group *A_ha* to user-level data ...done!
Merging group indicator for group *B_ha* to user-level data ...done!
Merging group indicator for group *D_ha* to user-level data ...done!
Merging group indicator for group *F_ha* to user-level data ...done!
Merging group indicator for group *A_ma* to user-level data ...done!
Merging group indicator for group *B_ma* to user-level data ...done!
Merging group indicator for group *D_ma* to user-level data ...done!
Merging group indicator for group *F_ma* to user-level data ...done!
Merging group indicator for group *A_la* to user-level data ...done!
Merging group indicator for group *B_la* to user-level data ...done!
Merging group indicator for group *D_la* to user-level data ...done!
Merging group indicator for group *F_la* to user-level data ...done!
Loading data 'user_demographics.csv'... done!
Merging demographics...done!
Merging dosage_no_trump_0...done!
Merging dosage_no_trump_1...done!
Merging dosage_no_trump_10...done!
Merging dosage_no_trump_2...done!
Merging dosage_no_trump_3...done!
Merging dosage_no_trump_4...done!
Merging dosage_no_trump_5...done!
Merging dosage_no_trump_6...done!
Merging dosage_no_trump_7...done!
Merging dosage_no_trump_8...done!
Merging dosage_no_trump_9...done!
Merging dosage_trump_0...done!
Merging dosage_trump_1...done!
Merging dosage_trump_10...done!
Merging dosage_trump_2...done!
Merging dosage_trump_3...done!
Merging dosage_trump_4...done!
Merging dosage_trump_5...done!
Merging dosage_trump_6...done!
Merging dosage_trump_7...done!
Merging dosage_trump_8...done!
Merging dosage_trump_9...done!
Creating tweet and retweet (fake or not fake column for nfs/nfns)...done!
Saving panel data with daily totals (panel-2016-daily-totals.csv)...done!
Saving panel data with daily totals (panel-2020-daily-totals.csv)...done!
Saving panel data with daily totals (decahose-daily-totals.csv)...done!
Saving panel user level data for DiD (panel-2020-user-level-did.csv)...done!
Saving user ids for each group...done!
All done!
